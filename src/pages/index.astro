---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Divider from '../components/Divider.astro';
import HeroSection from '../components/sections/HeroSection.astro';
import ReviewsSection from '../components/sections/ReviewsSection.astro';
import InstagramPromoSection from '../components/sections/InstagramPromoSection.astro';
import StudioSection from '../components/sections/StudioSection.astro';
import WalkInTattoosSection from '../components/sections/WalkInTattoosSection.astro';
import StylesSection from '../components/sections/StylesSection.astro';
import ArtistsSection from '../components/sections/ArtistsSection.astro';
import ValuesSection from '../components/sections/ValuesSection.astro';
import { getCollection } from 'astro:content';
import { resolveImagePath } from '../utils/contentHelpers';

// Get homepage content
const homepageEntries = await getCollection('homepage');
const homepage = homepageEntries[0]?.data || {};

// Resolve image paths (handles R2 URLs automatically)
const topRightImage = homepage.topRightImage ? resolveImagePath(homepage.topRightImage) : undefined;
const bottomLeftImage = homepage.bottomLeftImage ? resolveImagePath(homepage.bottomLeftImage) : undefined;
---

<Layout>
	<Header />
	<main>
		<HeroSection 
			headline={homepage.headline}
			introText={homepage.introText}
			ctaText={homepage.ctaText}
			ctaHref={homepage.ctaHref}
			videoSrc={homepage.videoSrc}
			streamVideoId={homepage.streamVideoId}
			streamCustomerCode={homepage.streamCustomerCode}
			topRightImage={topRightImage}
			bottomLeftImage={bottomLeftImage}
		/>
		<ReviewsSection />
		<Divider />
		<InstagramPromoSection backgroundImage="/images/stay-tuned-bg.png" />
		<Divider />
		<StudioSection />
		<Divider />
		<WalkInTattoosSection backgroundImage="/images/walk-in-tattoos-bg.png" />
		<Divider />
		<StylesSection />
		<Divider />
		<ValuesSection />
		<Divider />
		<ArtistsSection />
		<Divider />
	</main>
	<Footer />
</Layout>

<style>
	main {
		width: 100%;
		min-height: 100vh;
		display: flex;
		flex-direction: column;
		align-items: center;
		overflow-x: visible;
		overflow-y: visible;
		padding-top: 72px; /* Account for fixed header height */
	}
</style>
